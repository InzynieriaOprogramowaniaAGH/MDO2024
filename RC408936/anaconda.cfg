# Generated by Anaconda 38.23.4
# Generated by pykickstart v3.47
# version=F38

# Use text mode install
text

# Keyboard layouts
keyboard --vckeymap=pl --xlayouts='pl'

# System language
lang pl_PL.UTF-8

# Network configuration
network --bootproto=dhcp --device=link --onboot=on --activate

#Root password
user --groups=wheel --name=kszanu --password=Chrzanu312

# System timezone
timezone Europe/Warsaw --utc

# System bootloader configuration
bootloader --location=mbr --boot-drive=sda

# Clear the Master Boot Record
zerombr

# Partition clearing information
clearpart --all --initlabel

# Disk partitioning information
autopart

url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-38&arch=x86_64
repo --name=updates --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f38&arch=x86_64

%packages
@^server-product-environment
@headless-management
# Dodaj tutaj dodatkowe pakiety z maszyny Fedora-2
podman

# Additional repositories
%end

%post --nochroot --log=/mnt/sysimage/root/ks-post.log
#!/bin/bash

# Tworzenie pliku usługi systemd dla kontenera lighttpd w zainstalowanym systemie
cat <<EOF > /mnt/sysimage/etc/systemd/system/lighttpd-container.service
[Unit]
Description=Lighttpd Container
Wants=network-online.target
After=network-online.target

[Service]
Restart=always
ExecStart=/usr/bin/podman run --name my-lighttpd-container -p 80:80 --rm docker.io/jitesoft/lighttpd
ExecStop=/usr/bin/podman stop my-lighttpd-container

[Install]
WantedBy=multi-user.target
EOF
%end

%post --log=/root/ks-post-script.log
#!/bin/bash

# Włączanie usługi, aby startowała przy każdym uruchomieniu systemu
chroot /mnt/sysimage /usr/bin/systemctl enable lighttpd-container.service
%end

# Run the Setup Agent on first boot
firstboot --enable
